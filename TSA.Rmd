---
title: "Twitter_Sentiment_Analysis"
author: "Eli (Ilya) Bolotin"
date: "11/18/2018"
output: pdf_document
header-includes:
  - \usepackage{fvextra}
  - \DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load libraries

```{r cars}
library(dplyr)
library(ggplot2)
```

## Read in data for both groups: tweets of people who talk about fitness and people who talk about media.

This data has been procured and filtered in Python, and is ready for analysis. We are only concerned with the sentiment scores produces by NLTK's VADER algorith, and not those from TextBlob.

```{r, echo=FALSE}

setwd('Sample_1/')
group_1 <- read.csv("streamed_tweets_fitness_clean_full_analysis.csv", header=TRUE, sep=",")
group_2 <- read.csv("streamed_tweets_media_clean_full_analysis.csv", header=TRUE, sep=",")

```
## Combine both groups into single dataframe for analysis

```{r, echo=FALSE}

df_g1 <- data.frame(group = "group_1", vader_sentiment = group_1$sentiment_vader)
df_g2 <- data.frame(group = "group_2", vader_sentiment = group_2$sentiment_vader)
df_combined <- rbind(df_g1, df_g2)

```

## Plot boxplot of VADER sentiment scores to see distribution stats.
```{r, echo=FALSE}

qplot(x = group, y = vader_sentiment,
      geom = "boxplot", data = df_combined,
      xlab = "Group", 
      ylab = "Sentiment",
      fill = I("lightyellow"))

```

## Compute summary table of statistical metrics for both groups

```{r, echo=FALSE}

analysis <- df_combined %>%
    group_by(group) %>%
    dplyr::summarize(
      group_size = n(),
      median_sentiment = median(vader_sentiment),
      mean.sentiment = mean(vader_sentiment),
      sd.sentiment = sd(vader_sentiment),
      se.mean.sentiment = sd.sentiment / sqrt(group_size)
      )

analysis

```

## Run (Welch's) T-Test to determine if the means of both groups are significantly different.

```{r, echo=FALSE}

t.test <- t.test(vader_sentiment ~ group, var.equal = FALSE, data = df_combined)
t.test

```

